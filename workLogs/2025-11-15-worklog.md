# 2025-11-15 Editor Improvements

## Note Content Storage: JSON to HTML Migration

### Changes
- **Files**:
  - [packages/database/prisma/schema.prisma](packages/database/prisma/schema.prisma)
  - [apps/web/app/(dashboard)/notes/new/page.tsx](apps/web/app/(dashboard)/notes/new/page.tsx)
  - [apps/web/app/(dashboard)/notes/[id]/page.tsx](apps/web/app/(dashboard)/notes/[id]/page.tsx)
  - [apps/web/lib/api/notes.ts](apps/web/lib/api/notes.ts)
- **Type**: Database schema change, API update
- **Commit**: TBD

### Details
노트 콘텐츠 저장 방식을 TipTap JSON 객체에서 HTML string으로 변경했습니다.

#### Database Schema
**Before**:
```prisma
content     Json     // TipTap JSON content
```

**After**:
```prisma
content     String   @db.Text
```

#### Frontend - Note Creation
**Before**:
```typescript
const jsonContent = editor?.getJSON() || { type: "doc", content: [] };
const noteData = {
  title,
  content: jsonContent,
};
```

**After**:
```typescript
const htmlContent = editor?.getHTML() || "";
const noteData = {
  title,
  content: htmlContent,
};
```

#### Frontend - Note Display
**Before**:
```typescript
const content = typeof note.content === "string" ? note.content : JSON.stringify(note.content);
<TipTapEditor content={content as string | undefined} />
```

**After**:
```typescript
<TipTapEditor content={note.content} />
```

#### API Types
**Before**:
```typescript
content: any; // TipTap JSON content
```

**After**:
```typescript
content: string; // HTML string
```

### Rationale
- **단순화**: String 타입으로 데이터 구조 단순화
- **에디터 독립성**: TipTap 외 다른 에디터로 마이그레이션 용이
- **타입 안정성**: `any` 타입 제거로 타입 안정성 향상
- **코드 간결성**: 불필요한 타입 변환 및 예외 처리 제거

### Migration
- `prisma db push`로 스키마 변경 적용
- 기존 JSON 데이터는 수동 마이그레이션 필요 (DB 초기화로 해결)

---

## TipTap Editor Style Updates

### Changes
- **File**: [apps/web/app/(dashboard)/notes/new/page.tsx](apps/web/app/(dashboard)/notes/new/page.tsx)
- **Type**: Style improvement
- **Commit**: 8a2eb38

### Details
TipTapEditor의 `min-h-[500px]` 클래스를 제거하여 더 유연한 레이아웃을 허용하도록 개선했습니다.

**Before**:
```tsx
<TipTapEditor
  placeholder="노트 내용을 입력하세요..."
  onUpdate={handleEditorUpdate}
  className="min-h-[500px]"
/>
```

**After**:
```tsx
<TipTapEditor
  placeholder="노트 내용을 입력하세요..."
  onUpdate={handleEditorUpdate}
/>
```

### Rationale
- 에디터가 컨텐츠에 따라 자연스럽게 크기 조절 가능
- 불필요한 최소 높이 제약 제거로 더 나은 UX 제공
- TipTapEditor 컴포넌트 내부에서 적절한 높이 관리 가능
